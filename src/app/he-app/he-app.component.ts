import { Component } from '@angular/core';
import { HeAppService } from '../services/he-app.service';
import { HeAppResult } from '../models/he-app-result-model';

@Component({
  selector: 'app-he-app',
  templateUrl: './he-app.component.html',
  styleUrls: ['./he-app.component.css']
})
export class HeAppComponent {
  target: string = '';
  scanResults: HeAppResult[] = [];
  loading: boolean = false;
  error: string | null = null;
  profiles = [
    { label: 'Intense Scan', value: 'intense_scan' },
    { label: 'Intense Scan plus UDP', value: 'intense_scan_udp' },
    { label: 'Intense Scan, all TCP ports', value: 'intense_all_tcp' },
    { label: 'Intense Scan, no ping', value: 'intense_no_ping' },
    { label: 'Ping Scan', value: 'ping_scan' },
    { label: 'Quick Scan', value: 'quick_scan' },
    { label: 'Quick Scan plus', value: 'quick_scan_plus' },
    { label: 'Quick traceroute', value: 'quick_traceroute' },
    { label: 'Regular Scan', value: 'regular_scan' },
    { label: 'Slow comprehensive scan', value: 'slow_comprehensive' }
  ];
  
  selectedProfile: string = '';
  

  constructor(private heAppService: HeAppService) {}

  onScan(): void {
    if (!this.target.trim()) {
      this.error = "Target cannot be empty!";
      return;
    }

    this.loading = true;
    this.error = null;

    this.heAppService.runScan(this.target.trim()).subscribe({
      next: (results: HeAppResult[]) => {
        this.scanResults = results;
        this.loading = false;
      },
      error: (err) => {
        this.error = 'An error occurred while fetching scan results.';
        this.loading = false;
        console.error(err);
      }
    });
  }
}
